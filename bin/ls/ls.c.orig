#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <dirent.h>
#include <sys/defs.h>

char *file_type = "-lscbdfc";
int main(int argc, char* argv[], char* envp[]) {

<<<<<<< HEAD
	printf("************In ls argv*************\n");

	for(int i=0 ;i < argc ; i++){
		puts(argv[i]);
		puts("\n");
	}
	printf("************In ls argv************* %d\n", argc);



	char buff[NAME_MAX+1];
	memset(buff, '\0', NAME_MAX+1);
	if(argc == 1){
		getcwd(buff, NAME_MAX+1);
	}else if(argc == 2){
		strcpy(buff, argv[1]);
	}else{
		puts("Multiple directories not supported\n");
	}
	//puts(buff);
	int fidx = open(buff, 0);
	struct dirent dir_buff ;
	struct dirent* ptr_dir = &dir_buff;
	ptr_dir->offset=fidx;
	memset(dir_buff.d_name, '\0', sizeof(dir_buff.d_name));
	while(getdents(fidx, ptr_dir, 100) !=-1){

		printf("%crwx--x--x    %5dKB ", file_type[dir_buff.type], dir_buff.size/1024);
		printf("%s\n",ptr_dir->d_name);

		//puts("\n");
		memset(dir_buff.d_name, '\0', sizeof(dir_buff.d_name));

	}

||||||| merged common ancestors
   int    num_dirs;
   int    fd;
   char   dir_struct[2048];
   struct dirent* p;
   char   dir_path[NAME_MAX+1];

   if(argc == 1) {
     getcwd(dir_path, (size_t) NAME_MAX+1);
     fd = open(dir_path, O_RDONLY | O_DIRECTORY); 
   }
   else {
     fd = open(argv[1], O_RDONLY | O_DIRECTORY);
   }

   if(fd == -1) {
     puts("Directory not found");
     return 1;
   }

   num_dirs = getdents(fd, dir_struct, 1024);

   int pos = 0;
   while(pos < num_dirs) {
     p = (struct dirent *) (dir_struct + pos);
     puts(p->d_name);
     pos += p->reclen;
   }
  
   close(fd);

   return 0;
=======
   int    num_dirs;
   int    fd;
   char   dir_struct[2048];
   struct dirent* p;
   char   dir_path[NAME_MAX+1];

   if(argc == 1) {
     getcwd(dir_path, (size_t) NAME_MAX+1);
     fd = open(dir_path, O_RDONLY | O_DIRECTORY); 
   }
   else {
     fd = open(argv[1], O_RDONLY | O_DIRECTORY);
   }

   if(fd == -1) {
     puts("Directory not found");
     return 1;
   }

   num_dirs = getdents(fd, (struct dirent *) dir_struct, 1024);

   int pos = 0;
   while(pos < num_dirs) {
     p = (struct dirent *) (dir_struct + pos);
     puts(p->d_name);
     pos += p->reclen;
   }
  
   close(fd);

   return 0;
>>>>>>> e6b7680e5219ebb988e754c6b9877e247e68c3b1
}
